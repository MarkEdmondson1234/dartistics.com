<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Microsoft Excel (!)</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">DARTISTICS</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="example1.html">Example: Trending</a>
    </li>
    <li>
      <a href="example2.html">Example: Data Explorer</a>
    </li>
    <li>
      <a href="example3.html">Example: Venn Diagram</a>
    </li>
    <li>
      <a href="example4.html">Example: GA Effect</a>
    </li>
    <li>
      <a href="example5.html">Example: Heatmap</a>
    </li>
    <li>
      <a href="example6.html">Example: Forecasting</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    R Programming
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">THE BASICS</li>
    <li>
      <a href="whatisr.html">What Is R?</a>
    </li>
    <li>
      <a href="gettingstarted.html">Getting Started</a>
    </li>
    <li>
      <a href="packages.html">Packages</a>
    </li>
    <li>
      <a href="basics-base_r.html">Basics of Base R</a>
    </li>
    <li>
      <a href="exercise1-thebasics.html">Exercise: The Basic Basics</a>
    </li>
    <li class="dropdown-header">ADVANCED TOPICS</li>
    <li>
      <a href="fast-r-code.html">Fast R code</a>
    </li>
    <li>
      <a href="functions.html">Using R functions</a>
    </li>
    <li>
      <a href="creating-packages.html">Creating R packages</a>
    </li>
    <li>
      <a href="cloud-computing.html">Cloud computing &amp; R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    I/O
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">WORKING WITH FILES</li>
    <li>
      <a href="import-csv-excel.html">CSV import</a>
    </li>
    <li>
      <a href="excel.html">Microsoft Excel(!)</a>
    </li>
    <li>
      <a href="exercise2-io.html">Exercise: I/O</a>
    </li>
    <li class="dropdown-header">WORKING WITH APIs</li>
    <li>
      <a href="api-google-analytics.html">Google Analytics</a>
    </li>
    <li>
      <a href="api-adobe-analytics.html">Adobe Analytics</a>
    </li>
    <li>
      <a href="api-other.html">Other APIs</a>
    </li>
    <li>
      <a href="creating-apis.html">Create API libraries</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data Structures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">R CLASSES AND SYNTAX</li>
    <li>
      <a href="classes.html">R Classes</a>
    </li>
    <li>
      <a href="accessing.html">Accessing elements</a>
    </li>
    <li>
      <a href="learn-to-love-lists.html">Learn to love lists</a>
    </li>
    <li>
      <a href="exercise3-accessing-data.html">Exercise: Accessing Data</a>
    </li>
    <li class="dropdown-header">BASE R vs. TIDY</li>
    <li>
      <a href="tidyverse.html">Tidy data / Tidyverse</a>
    </li>
    <li>
      <a href="dplyr.html">dplyr()</a>
    </li>
    <li>
      <a href="exercise4-tidy-dplyr.html">Exercise: Tidy Data / dplyr</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Statistics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="modelling-intro.html">Introduction</a>
    </li>
    <li>
      <a href="nature-of-data.html">Nature of Data</a>
    </li>
    <li>
      <a href="cross-tab-w-chi-square.html">Chi Square</a>
    </li>
    <li>
      <a href="anova.html">ANOVA</a>
    </li>
    <li>
      <a href="correlation.html">Correlation</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="timeseries.html">Time-series</a>
    </li>
    <li>
      <a href="categorisation.html">Categorisation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Output
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="viz-options.html">Visualisation Options</a>
    </li>
    <li>
      <a href="base-plots.html">Base Plots</a>
    </li>
    <li>
      <a href="ggplot2.html">ggplot2()</a>
    </li>
    <li>
      <a href="htmlwidgets.html">htmlwidgets()</a>
    </li>
    <li>
      <a href="rmarkdown-shiny.html">RMarkdown + Shiny</a>
    </li>
    <li>
      <a href="advanced-rmarkdown.html">Advanced RMarkdown</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Resources
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="resources.html">Useful Links</a>
    </li>
    <li>
      <a href="key-topics.html">Key topics</a>
    </li>
    <li>
      <a href="github.html">GitHub</a>
    </li>
    <li>
      <a href="habits.html">Good Habits</a>
    </li>
    <li>
      <a href="going-further.html">Going Further</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-N4DF7T"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-N4DF7T');</script>
<!-- End Google Tag Manager -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Microsoft Excel (!)</h1>

</div>


<p>As interesting as the world would be if the emergence of R removed Microsoft Excel from our lives entirely, that is unlikely to be the reality for most analysts. Below are some of the most likely ways you will need to use R and Excel in tandem:</p>
<ul>
<li><strong>As a Data Input</strong> – for platforms where there is no API or where there is not already a reasonably mature R package for accessing the API, it can make sense to simply export data into a format like Microsoft Excel and then import it into R to use it.</li>
<li><strong>As an Output/Deliverable Vehicle</strong> – many of your stakeholders likely won’t <em>have</em> R, and it’s not always going to make sense to deliver information to them as a web-based platform, a presentation, or a PDF. Excel can be a good way to deliver both raw data, as well as data with some base-level interactivity (using dropdowns and/or slicers in Excel).</li>
<li><strong>For Data Visualization</strong> – we will cover the <code>ggplot2</code> package later, but, especially as you are ramping up on R, it can be time-consuming to figure out an entirely different data visualization paradigm on top of all of the other aspects of R that are new and unique. It is <em>perfectly acceptable</em> to use R to efficiently access and crunch the data…but then switch to Excel for the final visualization. Just recognize that that does require hopping between platforms. We don’t recommend this approach as your long-term standard.</li>
</ul>
<p>Really, the second two items above are two sides of the same coin.</p>
<hr />
<div id="importing-from-excel" class="section level2">
<h2>Importing From Excel</h2>
<p>In general, it is easier to work with comma-delimited text files (<code>.csv</code>) than with native Excel files (<code>.xlsx</code>). So, when you have a choice for exporting data from a platform, if <code>.csv</code> is an option, it’s generally best to go that route. But, there are options for bringing data in from <code>.xlsx</code> files, too.</p>
<div id="csv" class="section level3">
<h3>.csv</h3>
<p>The nice thing about <code>.csv</code> files is that they tend to be pretty clean. There are two main functions that are part of the <code>utils</code> package (which is loaded by many, many other packages) that can be used to read CSV files into a data frame:</p>
<ul>
<li><code>read.csv()</code> – the simplest form of this function is <code>read.csv(&quot;filename.csv&quot;)</code>. This assumes the first row in the file is a header.</li>
<li><code>read.csv2()</code> – this is identically structured as <code>read.csv()</code>, but is built for use in countries where the comma is used as a decimal point and a semicolon is used as a field separator.</li>
</ul>
</div>
<div id="clean-.xlsx" class="section level3">
<h3>(Clean) .xlsx</h3>
<p>A “clean” <code>.xlsx</code> file is one where the data is in a fairly raw form – it’s not, for instance, a dashboard with multiple tables arranged within the workbook. There are many options for bringing this sort of data in:</p>
<ul>
<li>In RStudio when you select Import Dataset you can select Excel as one of the options. This may prompt you to load <code>readxl</code>:</li>
</ul>
<div style="text-align: center">
<div class="figure">
<img src="images/fromexcel.png" />

</div>
</div>
<ul>
<li>The <code>xlsx</code> package has <code>read.xlsx()</code> and <code>read.xlsx2()</code> functions for specifying the workbook and the sheet from which you wish to bring data in.</li>
<li>The <code>gdata</code> package has a <code>read.xls()</code> function that works very similarly to the <code>xlsx</code> package.</li>
<li>The <code>XLConnect</code> package works a little bit differently, in that you first “load” the workbook (with <code>loadworkbook()</code>) and then “read” a workssheet from the workbook with a separate function (<code>readworksheet()</code>).</li>
</ul>
<p>There are enough quirks across platforms and files that it may take some experimentation to find the package and functions that work best in your situation.</p>
</div>
<div id="messy-.xlsx" class="section level3">
<h3>(Messy) .xlsx</h3>
<p>The least optimal type of data to bring in from Excel is one where the workbook has been formatted and organized – when the data it includes is not the “raw” data. If the workbook has “presentation layer” worksheets that are set up being highly formatted, while also having “raw data” worksheets that are flat tables, then, if it’s the raw data you need, you can likely use one of the packages described above.</p>
<p>However, if that is <em>not</em> the case, then the <code>jailbreakr</code> package may enable you to reliably import data: <a href="http://blog.revolutionanalytics.com/2016/08/jailbreakr.html" class="uri">http://blog.revolutionanalytics.com/2016/08/jailbreakr.html</a>.</p>
</div>
</div>
<div id="exporting-to-excel" class="section level2">
<h2>Exporting to Excel</h2>
<p>In many ways, exporting data is similar to importing data, in that the simpler/cleaner the requirements, the easier it is to perform the export.</p>
<div id="csv-1" class="section level3">
<h3>.csv</h3>
<p>If you need to export the data to a simple, flat, structure, then you can push it out as a simple <code>.csv</code> file. These two functions – both in the <code>utils</code> package – do the trick quite nicely:</p>
<ul>
<li><code>write.csv()</code> – simply specify what to output and the filename to which to output it. Type <code>?write.csv</code> for the complete documentation</li>
<li><code>write.csv2()</code> – just like <code>read.csv2()</code>, <code>write.csv2()</code> is designed for use in countries where a comma is used for a decimal point and a semicolon is used as the delimiter.</li>
</ul>
</div>
<div id="xlsx" class="section level3">
<h3>.xlsx</h3>
<p>If you have multiple data frames that you want to place on separate tabs in a single workbook, the <code>WriteXLS</code> package (<code>install.packages(&quot;WriteXLS&quot;)</code>) and then <code>library(WriteXLS)</code>) is one option for doing so. This can get a bit more involved, but it can also be quite useful. Let’s use an example where we have multiple data frame objects named <code>df1</code>, <code>df2</code>, and <code>df3</code>, and we want to output each data frame to its own worksheet in a workbook called <code>my_dataframes.xlsx</code>. We also want to rename the worksheet tabs to be <code>Data Frame 1</code>, <code>Data Frame 2</code>, and <code>Data Frame 3</code>. We would do that with the code below, and even do some light formatting on the output (having the columns automatically adjust their width, making the header row on each worksheet bold, and turning on autofiltering).</p>
<pre class="r"><code># Create a vector with the names of the data frame objects
sheet_data &lt;- c(&quot;df1&quot;, &quot;df2&quot;, &quot;df3&quot;)

# Create a vector with the worksheet names we want to use
sheet_names &lt;- c(&quot;Data Frame 1&quot;, &quot;Data Frame 2&quot;, &quot;Data Frame 3&quot;)
  
# Write out an Excel file with auto-width columns, a bolded header 
# row, and filters turned on.
WriteXLS(sheet_data,
         ExcelFileName = &quot;my_dataframes.xlsx&quot;,
         SheetNames = sheet_names,
         AdjWidth = TRUE, BoldHeaderRow = TRUE, AutoFilter = TRUE)</code></pre>
</div>
</div>
<div id="opening-files-in-excel" class="section level2">
<h2>Opening Files in Excel</h2>
<p>Opening files generated by R from Excel is just like opening files generated by any other platform:</p>
<ul>
<li><code>.csv</code> files – depending on the version of Excel and your operating system, the file may open automatically, or it may require that you tell Excel that the file is delimited and what the delimiter is (comma, semicolon, or other)</li>
<li><code>.xlsx</code> files – these <em>should</em> be native Excel file formats. If not – if there is an error when you try to open a <code>.xlsx</code> file generated from R – then the best bet is to try a different package for creating the file.</li>
</ul>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
