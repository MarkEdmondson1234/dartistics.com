<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Importing data - Excel and CSV</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="site_libs/highlight/default.css"
      type="text/css" />
<script src="site_libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R Masterclass</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Overview
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="intros.html">Introductions</a>
    </li>
    <li>
      <a href="whatisr.html">What Is R?</a>
    </li>
    <li>
      <a href="example1.html">Example: Trending</a>
    </li>
    <li>
      <a href="example2.html">Example: Data Explorer</a>
    </li>
    <li>
      <a href="example3.html">Example: Venn Diagram</a>
    </li>
    <li>
      <a href="example4.html">Example: GA Effect</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="exercise1-thebasics.html">1. The Basic Basics</a>
    </li>
    <li>
      <a href="exercise2-io.html">2. I/O</a>
    </li>
    <li>
      <a href="exercise3-accessing-data.html">3. Accessing Data</a>
    </li>
    <li>
      <a href="exercise4-tidy-dplyr.html">4. Tidy Data / dplyr()</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Basics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="rstudio.html">RStudio</a>
    </li>
    <li>
      <a href="packages.html">Packages</a>
    </li>
    <li>
      <a href="import-csv-excel.html">CSV import</a>
    </li>
    <li>
      <a href="basics-base_r.html">Basics of Base R</a>
    </li>
    <li>
      <a href="classes.html">R Classes</a>
    </li>
    <li>
      <a href="accessing.html">Accessing elements</a>
    </li>
    <li>
      <a href="tidyverse.html">Tidy data / Tidyverse</a>
    </li>
    <li>
      <a href="dplyr.html">dplyr()</a>
    </li>
    <li class="dropdown-header">  Input</li>
    <li>
      <a href="analytics-apis.html">Analytics APIs</a>
    </li>
    <li>
      <a href="excel.html">Microsoft Excel(!)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Modelling
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="modelling-intro.html">Introduction</a>
    </li>
    <li>
      <a href="correlation.html">Correlation</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="timeseries.html">Time-series</a>
    </li>
    <li>
      <a href="categorisation.html">Categorisation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Output
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">  Visualisation</li>
    <li>
      <a href="viz-options.html">Visualisation Options</a>
    </li>
    <li>
      <a href="base-plots.html">Base Plots</a>
    </li>
    <li>
      <a href="ggplot2.html">ggplot2()</a>
    </li>
    <li>
      <a href="htmlwidgets.html">htmlwidgets()</a>
    </li>
    <li class="dropdown-header">  Presentation</li>
    <li>
      <a href="rmarkdown.html">RMarkdown</a>
    </li>
    <li>
      <a href="shiny.html">Shiny</a>
    </li>
    <li>
      <a href="rmarkdown-shiny.html">RMarkdown + Shiny</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Wrap-Up
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="key-topics.html">Key topics</a>
    </li>
    <li>
      <a href="github.html">GitHub</a>
    </li>
    <li>
      <a href="habits.html">Good Habits</a>
    </li>
    <li>
      <a href="going-further.html">Going further</a>
    </li>
  </ul>
</li>
<li>
  <a href="resources.html">R Linkfest</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Importing data - Excel and CSV</h1>

</div>


<div id="importing-csv" class="section level2">
<h2>Importing CSV</h2>
<p>The most universal data format is <code>.csv</code> (comma-separated variables).</p>
<p><code>.csv</code> is a format that almost every program can open, and also has the advantage of being human-readable if you open it for examination with, say, notepad.</p>
<div id="read.csv" class="section level3">
<h3>read.csv()</h3>
<p>See <code>?read.csv</code> to get an overview of the arguments for importing csv.</p>
<p>When you do, you see that <code>read.csv</code> is a derived function from the more general <code>read.table</code> function that can read other formats such as tab seperated (<code>.tsv</code>).</p>
<p><code>read.csv()</code> basically hardcodes defaults suitable for <code>.csv</code> in the UK/US, whilst <code>read.csv2()</code> has defaults set for European formats where currency uses a comma, <code>,</code>, which to avoid confusion means a semi-colon <code>;</code> is used instead to seperate values.</p>
<p>A helpful argument to also include is <code>stringsAsFactors = FALSE</code> - a classic R quirk, it stops future problems where R treats strings as factors that may cause unexpected results.</p>
</div>
<div id="example-import-csv" class="section level3">
<h3>Example import csv</h3>
<p>A demo .csv file is available from <a href="http://bit.ly/rSampleGA" class="uri">http://bit.ly/rSampleGA</a>.</p>
<p>Saving it to the <code>./data/</code> folder of the project then allows you to import the data via below:</p>
<pre class="r"><code>## a csv available from the data folder
filename &lt;- &quot;./data/td.csv&quot;
mydata &lt;- read.csv(filename, stringsAsFactors = FALSE)
head(mydata)
      X       date sessions bounceRate      ratio
1     1 2015-01-01        6   83.33333 0.07200000
2     2 2015-01-02       15   93.33333 0.16071429
3     3 2015-01-03        7  100.00000 0.07000000
4     4 2015-01-04        8   75.00000 0.10666667
5     5 2015-01-05       21   76.19048 0.27562500
6     6 2015-01-06       20   95.00000 0.21052632</code></pre>
<p>I then often use <code>str()</code> on the data.frame to check the types and possibly change them, and <code>names()</code> to change the column names to more descriptive or useful names.</p>
<p>In this example the redundant <code>X</code> column (row number) and <code>ratio</code> (useless) is also deleted by setting it to NULL:</p>
<pre class="r"><code>str(mydata)
&#39;data.frame&#39;:   545 obs. of  5 variables:
 $ X         : int  1 2 3 4 5 6 7 8 9 10 ...
 $ date      : chr  &quot;2015-01-01&quot; &quot;2015-01-02&quot; &quot;2015-01-03&quot; &quot;2015-01-04&quot; ...
 $ sessions  : int  6 15 7 8 21 20 13 23 16 13 ...
 $ bounceRate: num  83.3 93.3 100 75 76.2 ...
 $ ratio     : num  0.072 0.161 0.07 0.107 0.276 ...
 
## get rid of X and ratio column
mydata$X &lt;- NULL
mydata$ratio &lt;- NULL

## change the names
names(mydata) &lt;- c(&quot;Date&quot;, &quot;Visits&quot;, &quot;BounceRate&quot;)

## see top 6 rows
head(mydata)
        Date Visits BounceRate
1 2015-01-01      6   83.33333
2 2015-01-02     15   93.33333
3 2015-01-03      7  100.00000
4 2015-01-04      8   75.00000
5 2015-01-05     21   76.19048
6 2015-01-06     20   95.00000</code></pre>
</div>
</div>
<div id="importing-excel" class="section level2">
<h2>Importing Excel</h2>
<p>Importing from Excel can be problematic, as its not a fixed format. For example, a Danish workbook can hold different date and currency formats and use characters (ø, å etc.) that aren’t available. Here are a few strategies:</p>
<div id="import-a-csv-instead" class="section level3">
<h3>Import a csv instead</h3>
<p>By far the most simple and reliable way for tabular Excel data is to avoid importing it at all, and instead save your worksheet as a <code>.csv</code>.</p>
<p>In Excel, this is achieved by clicking <code>File &gt; Save As</code> and selecting the CSV format.</p>
<p>You can then import this to R via <code>read.csv()</code>.</p>
</div>
<div id="import-using-rstudios-import-dataset" class="section level3">
<h3>Import using RStudio’s Import Dataset</h3>
<p>The second easiest option is to use the <code>Import Dataset</code> button in the <code>Environment</code> tab of RStudio. In the latest versions of RStudio this calls <code>library(readxl)</code> to import the Excel data in for you.</p>
</div>
<div id="libraryreadxl" class="section level3">
<h3>library(readxl)</h3>
<p>If you have an older version of RStudio or importing non-interactivly via a script, you can call <code>library(readxl)</code> yourself once installed. This Hadley Wickham library has presets to handle Excel data for you. There are other libraries out there to read from Excel, but some require Java or similar to work. <code>readxl</code> is the best and quickest one the author has found so far.</p>
</div>
</div>
<div id="exporting-to-excel" class="section level2">
<h2>Exporting to Excel</h2>
<p>Note none of the above lets you write or save files to Excel - the author would prefer you use one of R’s superior formats instead. ;-)</p>
<p>But if you need it, then there are some options:</p>
<div id="import-a-csv-into-excel" class="section level3">
<h3>Import a csv into Excel</h3>
<p>This is the one used the most - export as a CSV then use Excel’s <code>Import Data</code> option in the top ribbon to import the file. Set the delimiter to “,” or “;” as necessary, and you are good to go.</p>
</div>
<div id="use-a-write-to-excel-library" class="section level3">
<h3>Use a write to Excel library</h3>
<p>There are other options to write to Excel using R libraries:</p>
<pre class="r"><code>## need to install Java
library(xlsx)
write.xlsx(mydata, &quot;c:/mydata.xlsx&quot;) </code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
